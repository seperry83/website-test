```{r}
# test
```

```{r}
report_analytes <- df_analytes %>%
  filter(Program == 'DEMP') %>%
  pull(Analyte)

for (param in report_analytes){
  plt <- fig_dwq$wq_return_plt(param, 'dwq')
  
  height_factor <- fig_dwq$df_raw %>%
    pull(Region) %>%
    unique() %>%
    length()
  
  exp_height <- (3*height_factor)
  
  ggsave(here::here(paste0('admin/figures-tables/dwq/test_', param, '.jpg')), 
             plt_do, width = 3.5, height = dynamic_height, unit = 'in')
}
```


```{r}
fig_dwq <- WQFigureClass$new(obj_dwq_cur$df_raw)
```


```{r}
fig_dwq$wq_return_plt('DissAmmonia', 'dwq')

ggsave('C:/Users/sperry/Desktop/dwq_plt_example.png', test_fig)
```

```{r}
fig_dwq$wq_return_plt('DissAmmonia', 'dwq', 'Confluence')
```

```{r}
generate_skip_gradient <- function(center_hex, num_colors = 5, skip_factor = 2, lighten_amount = 0.4, darken_amount = 0.4) {
  # Lighten the center color
  darkened_color <- colorspace::darken(center_hex, amount = darken_amount)
  lightened_color <- colorspace::lighten(center_hex, amount = lighten_amount)

  # Generate a sequence of colors from the lightened color to the center color
  base_palette <- colorRampPalette(c(lightened_color, darkened_color))(num_colors * skip_factor)

  # Skip steps by using the skip_factor to get more distinct color transitions
  skipped_palette <- colorspace::base_palette[seq(1, length(base_palette), by = skip_factor)]

  # Return the skipped palette
  return(skipped_palette)
}
# 
# # Generate a palette with 5 distinct colors using hue skipping logic
# palette <- generate_skip_gradient("#FF5733", num_colors = 5, skip_factor = 5)
# 
# # Create a sample data frame for plotting
# df <- data.frame(
#   x = rep(1:10, times = 5),
#   y = unlist(lapply(1:5, function(i) i * (1:10))),
#   group = rep(1:5, each = 10)
# )
# 
# # Plot using the generated palette
# ggplot(df, aes(x = x, y = y, color = as.factor(group))) +
#   geom_line(size = 1.2) +
#   geom_point(size = 3) +
#   scale_color_manual(values = palette) +
#   theme_bw() +  # Apply theme_bw
#   labs(title = 'test',
#        color = "Group")


```
```{r}
palette
```


```{r}
palette
```

