---
title: "Discrete Water Quality Report"
---

```{r echo = FALSE}
# read in functions; do not edit
source(here::here('admin/import_scripts.R'))
```

## Introduction

The Department of Water Resources (DWR) and the US Bureau of Reclamation (USBR) are required by Water Right Decision 1641 (D-1641) to collect discrete water chemistry data to monitor the water quality at select sites in the upper San Francisco Estuary (Estuary). This report describes the results of these monitoring efforts for water year `r report_year` (October 1st `r prev_year` through September 30th `r report_year`), which was classified as a `r get_water_year()` year in the Sacramento Valley [(source)](https://cdec.water.ca.gov/reportapp/javareports?name=WSIHIST). Results are compared to the previous water year, which was classified as a `r get_water_year(prev_year)` year.

## Methods

Discrete water quality samples were collected monthly at 24 monitoring sites throughout the Upper Estuary and were grouped into regions based on their geographic location (@fig-stations; @tbl-stations). These sites represent a variety of aquatic habitats, from narrow, freshwater channels to broad, estuarine bays.

```{r echo=FALSE, fig.align='center',  out.width = '70%'}
#| label: fig-stations
#| fig-cap: 'test'
#| 
knitr::include_graphics(file.path('../../../admin/figures/dwq/d-wq_station_map.jpg'))
```

```{r echo=FALSE, warning=FALSE, message=FALSE, results = 'asis'}
#| label: tbl-stations
#| tbl-cap: 'test'

dwq_stations <- readr::read_csv(here::here('admin/figures-tables/dwq/dwq-stations.csv'))

styler$style_kable(dwq_stations)
```

EMP collects data for six different field parameters and 18 different laboratory constituents. The analytes highlighted in this report are:

-   Specific Conductance (μS/cm)
-   Turbidity (FNU)
-   Dissolved Ammonia (mg/L)
-   Chlorophyll *a* (μg/cm)
-   Dissolved Nitrate+Nitrite (mg/L)
-   Total Phosphorus (mg/L)

Regional facet graphs were created for each parameter. The average, minimum and maximum values were determined for each analyte. Non-detect values were represented graphically via a vertical dashed line capped at the reporting limit. Average summary statistics are reported as the median (M) ± the median average deviation.

For more in-depth methodology, see [here](https://portal.edirepository.org/nis/metadataviewer?packageid=edi.1320.6).

## Results

### Specific Conductance

The average specific conductance value was `r strings_dwq_cur$disp_val_range('SpCndSurface','median')`; for comparison, the previous year average was `r strings_dwq_prev$disp_val_range('SpCndSurface','median')`. Values ranged from `r strings_dwq_cur$disp_extreme_range('SpCndSurface')`. `r strings_dwq_cur$disp_nondetect_perc('SpCndSurface')` Per region average, minimum, and maximum values are shown in @tbl-spc; time series plots are shown in @fig-spc.

```{r echo=FALSE, fig.align='center', results='asis'}
#| label: tbl-spc
#| tbl-cap: 'test'
 
summary_spc <- table_dwq$clone(deep=TRUE)
summary_spc$create_summary_df('SpCndSurface', 'median')
summary_spc$create_kable()
```

```{r echo=FALSE, fig.align='center', results='asis'}
#| label: fig-spc
#| tbl-cap: 'test'
 
knitr::include_graphics(here::here(file.path('admin/plots/dwq/ARGraph_SpCndSurface.jpg')))
```

### Turbidity

The average turbidity value was `r strings_dwq_cur$disp_val_range('TurbiditySurface','median')`; for comparison, the previous year average was `r strings_dwq_prev$disp_val_range('TurbiditySurface','median')`. Values ranged from `r strings_dwq_cur$disp_extreme_range('TurbiditySurface')`. `r strings_dwq_cur$disp_nondetect_perc('TurbiditySurface')` Per region average, minimum, and maximum values are shown in @tbl-turb; time series plots are shown in @fig-turb

```{r echo=FALSE, fig.align='center'}
#| label: tbl-turb
#| tbl-cap: 'test'

summary_turb <- table_dwq$clone(deep=TRUE)
summary_turb$create_summary_df('TurbiditySurface', 'median')
summary_turb$create_kable()
```

```{r echo=FALSE, fig.align='center', results='asis'}
#| label: fig-turb
#| tbl-cap: 'test'
 
knitr::include_graphics(here::here(file.path('admin/plots/dwq/ARGraph_TurbiditySurface.jpg')))
```

### Dissolved Ammonia

The average dissolved ammonia value was `r strings_dwq_cur$disp_val_range('DissAmmonia','median')`; for comparison, the previous year average was `r strings_dwq_prev$disp_val_range('DissAmmonia','median')`. Values ranged from `r strings_dwq_cur$disp_extreme_range('DissAmmonia')`. `r strings_dwq_cur$disp_nondetect_perc('DissAmmonia')` Per region average, minimum, and maximum values are shown in @tbl-amm; time series plots are shown in @fig-amm.

```{r echo=FALSE, fig.align='center'}
#| label: tbl-amm
#| tbl-cap: 'test'

summary_amm <- table_dwq$clone(deep=TRUE)
summary_amm$create_summary_df('DissAmmonia', 'median')
summary_amm$create_kable()
```

```{r echo=FALSE, fig.align='center', results='asis'}
#| label: fig-amm
#| tbl-cap: 'test'
 
knitr::include_graphics(here::here(file.path('admin/plots/dwq/ARGraph_DissAmmonia.jpg')))
```

### Chlorophyll *a*

The average chlorophyll *a* value was `r strings_dwq_cur$disp_val_range('Chla','median')`; for comparison, the previous year average was `r strings_dwq_prev$disp_val_range('Chla','median')`. Values ranged from `r strings_dwq_cur$disp_extreme_range('Chla')`. `r strings_dwq_cur$disp_nondetect_perc('Chla')` Per region average, minimum, and maximum values are shown in @tbl-chla; time series plots are shown in @fig-chla.

```{r echo=FALSE, fig.align='center'}
#| label: tbl-chla
#| tbl-cap: 'test'

summary_chla <- table_dwq$clone(deep=TRUE)
summary_chla$create_summary_df('Chla', 'median')
summary_chla$create_kable()
```

```{r echo=FALSE, fig.align='center', results='asis'}
#| label: fig-chla
#| tbl-cap: 'test'
 
knitr::include_graphics(here::here(file.path('admin/plots/dwq/ARGraph_Chla.jpg')))
```

### Dissolved Nitrate + Nitrite

The average dissolved nitrate + nitrite value was `r strings_dwq_cur$disp_val_range('DissNitrateNitrite','median')`; for comparison, the previous year average was `r strings_dwq_prev$disp_val_range('DissNitrateNitrite','median')`. Values ranged from `r strings_dwq_cur$disp_extreme_range('DissNitrateNitrite')`. `r strings_dwq_cur$disp_nondetect_perc('DissNitrateNitrite')` Per region average, minimum, and maximum values are shown in @tbl-dnn; time series plots are shown in @fig-dnn.

```{r echo=FALSE, fig.align='center'}
#| label: tbl-dnn
#| tbl-cap: 'test'

summary_nn <- table_dwq$clone(deep=TRUE)
summary_nn$create_summary_df('DissNitrateNitrite', 'median')
summary_nn$create_kable()
```

```{r echo=FALSE, fig.align='center', results='asis'}
#| label: fig-dnn
#| tbl-cap: 'test'
 
knitr::include_graphics(here::here(file.path('admin/plots/dwq/ARGraph_DissNitrateNitrite.jpg')))
```

### Total Phosphorus

The average total phosphorus value was `r strings_dwq_cur$disp_val_range('TotPhos','median')`; for comparison, the previous year average was `r strings_dwq_prev$disp_val_range('TotPhos','median')`. Values ranged from `r strings_dwq_cur$disp_extreme_range('TotPhos')`. `r strings_dwq_cur$disp_nondetect_perc('TotPhos')` Per region average, minimum, and maximum values are shown in @tbl-phos; time series plots are shown in @fig-phos.

```{r echo=FALSE, fig.align='center'}
#| label: tbl-phos
#| tbl-cap: 'test'

summary_phos <- table_dwq$clone(deep=TRUE)
summary_phos$create_summary_df('TotPhos', 'median')
summary_phos$create_kable()
```

```{r echo=FALSE, fig.align='center', results='asis'}
#| label: fig-phos
#| tbl-cap: 'test'
 
knitr::include_graphics(here::here(file.path('admin/plots/dwq/ARGraph_TotPhos.jpg')))
```

## Interpretations

insert text here

## Archived Reports

Previous EMP discrete water quality reports can be found [here](https://github.com/emp-dwr/emp-website/tree/gh-pages/admin/archive/d-wq).
